# https://github.com/microsoft/winget-dsc
# yaml-language-server: $schema=https://aka.ms/configuration-dsc-schema/0.2

properties:
  resources:
    - resource: PSDscResources/Script
      id: Microsoft.WinGet.Client
      directives:
        description: Microsoft.WinGet.DSC/WinGetPackage requires the Microsoft.WinGet.Client module to be installed.
      settings:
        SetScript: |
          Install-Module -Name Microsoft.WinGet.Client -Force -Repository PSGallery | Out-Null;
        GetScript: |
          Get-Module -ListAvailable -Name Microsoft.WinGet.Client
        TestScript: |
          $modules = Get-Module -ListAvailable -Name Microsoft.WinGet.Client
          return $modules.Count -gt 0
    # $HOME\.local\bin 경로를 PATH에 추가
    - resource: PSDscResources/Script
      settings:
        GetScript: return $false
        TestScript: |
          $userEnv = [System.Environment]::GetEnvironmentVariable("PATH", "User");
          return $userEnv.Split(";") -contains "$HOME\.local\bin"
        SetScript: |
          $userEnv = [System.Environment]::GetEnvironmentVariable("PATH", "User");
          [System.Environment]::SetEnvironmentVariable("PATH", "$userEnv;$HOME\.local\bin", "User");


    - resource: Microsoft.WinGet.DSC/WinGetPackage
      id: vscode
      directives:
        description: Install Visual Studio Code
      settings:
        id: Microsoft.VisualStudioCode
        source: winget
    - resource: Microsoft.WinGet.DSC/WinGetPackage
      id: powershell
      directives:
        description: Install Powershell
      settings:
        id: Microsoft.PowerShell
        source: winget
    - resource: Microsoft.WinGet.DSC/WinGetPackage
      id: windows-terminal
      directives:
        description: Install Windows Terminal
      settings:
        id: Microsoft.WindowsTerminal
        source: winget
    - resource: Microsoft.WinGet.DSC/WinGetPackage
      id: firefox
      directives:
        description: Install firefox
      settings:
        id: Mozilla.Firefox
        source: winget

  configurationVersion: 0.2.0